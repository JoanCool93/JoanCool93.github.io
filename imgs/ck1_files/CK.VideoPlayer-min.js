window.CK=window.CK||{};CK.VideoPlayerManager={};CK.VideoPlayerManager=(function(k,f){var d=false,h=false,r,o=true,p=function(){if(d){return}k.HomeVideoController.initialize();k.BrandVideoController.initialize();k.TimelineVideoController.initialize();j();r=i();d=true},j=function(){var s=false;try{var t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(t){s=true}}catch(u){if(navigator.mimeTypes["application/x-shockwave-flash"]!=f){s=true}}h=s},n=function(){return !!document.createElement("video").canPlayType},i=function(){if(!n()){return false}var s=document.createElement("video");return s.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"').length!=0},l=function(){return h},m=function(){return r},q=function(s){k.HomeVideoController.registerPlayers(s)},b=function(s){k.BrandVideoController.registerPlayers(s)},c=function(s){o=false;k.VideoSliverController.registerPlayer(s)},e=function(s){},a=function(s){k.MediaSliverController.registerPlayers(s)},g=function(t){try{var u=$("#"+t);var v=u.parent().parent().parent().find(".video-spinner");if(v.size()>0){v.stop().delay(500).animate({opacity:0},300,function(){if(v){v.hide()}})}u.removeClass("visibility-hidden")}catch(s){}};k.HomeVideoController=function(){var t=false,C,v,D=[],F={},z=function(){if(t){return}t=true},u=function(H){v="home-";if(!h){$("#"+H).closest("."+v+"video-wrapper").remove()}else{if(F[H]==null){var G=new BC_Video_Item();G.init(H,v,true,false);D[H]=H;F[H]=G;C=F[H]}}},y=function(G){if(F[G]){return F[G]}else{return null}},s=function(G){if(F[G]){for(key in F){if(key!=G){F[key]["pause"]()}else{F[key]["play"]();C=F[key]}}}},w=function(G){if(F[G]){F[G].pause()}},E=function(){for(key in F){F[key].pause()}},x=function(){E();for(key in F){F[key].destroy();F[key]=null}F=[]},A=function(){for(var G in D){$("#"+G).closest("."+v+"video-wrapper").css("display","block")}},B=function(){E();C=null;for(key in F){F[key].destroy();F[key]=null}F={};D=[]};return{initialize:z,registerPlayers:u,getPlayerById:y,playById:s,pauseById:w,pauseAll:E,hideAll:x,showAll:A,destroy:B}}();k.BrandVideoController=function(){var t=false,D,v,E=[],G={},z=function(){if(t){return}t=true},u=function(I){v="brand-";if(!h){$("#"+I).closest("."+v+"video-wrapper").remove()}else{$("#"+I).closest("."+v+"video-wrapper").css("opacity",1);if(G[I]==null){var H=new BC_Video_Item();H.init(I,v,true,false);E[I]=I;G[I]=H;D=G[I]}}},y=function(H){if(G[H]){return G[H]}else{return null}},s=function(H){if(G[H]){for(key in G){if(key!=H){G[key]["pause"]()}else{G[key]["play"]();D=G[key]}}}},w=function(H){if(G[H]){G[H].pause()}},F=function(){for(key in G){G[key].pause()}},x=function(){F();D=null;for(key in G){G[key].destroy();G[key]=null}G={}},B=function(){for(var H in E){$($("#"+H).parent()).css("display","block")}},A=function(H){if(H){for(key in G){if(key==H){G[key]["pause"]();G[key].destroy();G[key]=null;delete G[key]}}}},C=function(){F();D=null;for(key in G){G[key].destroy();G[key]=null}G={};E=[]};return{initialize:z,registerPlayers:u,getPlayerById:y,playById:s,pauseById:w,pauseAll:F,hideAll:x,showAll:B,removeVideoItem:A,destroy:C}}();k.MediaSliverController=function(){var s=false,x,u,y=[],z={},v=function(){if(s){return}s=true},t=function(C){u="media-";if(z[C]==null){var B=new BC_Video_Item();B.init(C,u,false,true);y[C]=C;z[C]=B;x=z[C]}},A=function(){for(key in z){$($("#"+key).closest(".media-video-wrapper")).animate({opacity:0},300);z[key].pause()}},w=function(){s=false;A();x=null;for(key in z){if(z[key]){z[key].destroy();z[key]=null}}s=false;z={};y=[]};return{initialize:v,registerPlayers:t,pauseAll:A,destroy:w}}();k.VideoSliverController=function(){var y=false,v,t,x=function(){if(y){return}y=true},u=function(z){t="";v=new BC_Video_Item();v.init(z,t,false,true)},w=function(){if(v!=null){v.pause()}},s=function(){if(video1=null){v.pause();v.destroy()}y=false;v=null};return{initialize:x,registerPlayer:u,pause:w,destroy:s}}();k.TimelineVideoController=function(){var s=false,x,u,y=[],z={},v=function(){if(s){return}s=true},t=function(C){u="timeline-";if(z[C]==null){var B=new BC_Video_Item();B.init(C,u,false,true);y[C]=C;z[C]=B;x=z[C]}},A=function(){var B=brightcove.experiences;if(B){jQuery.each(B,function(E,G){try{var F=$(this).attr("id");if(F){var D=brightcove.api.getExperience(F);if(D){D.getModule(brightcove.api.modules.APIModules.VIDEO_PLAYER).pause()}}}catch(C){}})}},w=function(){s=false;A();x=null;for(key in z){if(z[key]){z[key].destroy();z[key]=null}}s=false;z={};y=[]};return{initialize:v,registerPlayers:t,pauseAll:A,destroy:w}}();_destroy=function(){video.destroy()},BC_Video_Item=function(){var t=false,C=false,z=false,s,A,x=null,v=null,u,B=null,y=null,w=null;_init=function(G,F,D,E){u=F;if(G){s=G}x=$("#"+s).closest("."+u+"video-wrapper");if(D){t=D}if(E){C=E}B=brightcove.api.getExperience(s);y=B.getModule(brightcove.api.modules.APIModules.VIDEO_PLAYER);w=B.getModule(brightcove.api.modules.APIModules.EXPERIENCE);w.addEventListener(brightcove.api.events.ExperienceEvent.TEMPLATE_READY,_onReady);y.addEventListener(brightcove.api.events.MediaEvent.ERROR,_onError);if(D){y.addEventListener(brightcove.api.events.MediaEvent.COMPLETE,_onComplete);y.addEventListener(brightcove.api.events.MediaEvent.COMPLETE,_onComplete)}if(E){y.addEventListener(brightcove.api.events.MediaEvent.PLAY,_onPlay);y.addEventListener(brightcove.api.events.MediaEvent.PLAY,_hideLink);y.addEventListener(brightcove.api.events.MediaEvent.STOP,_showLink)}},_onError=function(D){log(D)},_showLink=function(E){if(E.position>E.duration-0.2){var D=x.children("a");if(D){D.stop().show().animate({opacity:1},100)}video.seek(0)}},_hideLink=function(){var D=x.children("a");if(D){D.animate({opacity:0},300).hide()}};_play=function(){if(z){y.play()}},_pause=function(){if(z){y.pause()}},_onReady=function(D){var E=1000;z=true;x.trigger("home_player_ready_event");switch(u){case"":v=x.closest(".video-background-div").children(".video-spinner");break;case"media-":v=x.closest(".media-video-background").children(".video-spinner");break;case"timeline-":E=1500;v=x.closest(".timeline-background-div").find(".video-spinner");break}if(v!=null){v.stop().delay(1000).animate({opacity:0},300,function(){if(v){v.hide()}})}x.css("opacity",0);x.delay(E).animate({opacity:1},200)},_onPlay=function(D){x.trigger("remove-header");CK.Analytics.trackSliverClicks("play","video")},_onProgress=function(D){if(D.position>D.duration-0.2){y.seek(0)}},_onComplete=function(D){y.seek(0);y.play();CK.Analytics.trackSliverClicks("complete","video")},_hide=function(){if(x!=null){x.css({display:"none",opacity:0})}},_getVideoPlayer=function(){return y},_getID=function(){return A},_destroy=function(){if(y){y.pause()}if(x!=null){x.unbind();if(x.children(".video-spinner")){x.children(".video-spinner").stop().unbind().off()}x.parent().unbind().off();x.css({display:"none",opacity:0})}w.removeEventListener(brightcove.api.events.ExperienceEvent.TEMPLATE_READY,_onReady);y.removeEventListener(brightcove.api.events.MediaEvent.ERROR,_onError);if(t){y.removeEventListener(brightcove.api.events.MediaEvent.COMPLETE,_onComplete);y.removeEventListener(brightcove.api.events.MediaEvent.PROGRESS,_onProgress)}if(C){y.removeEventListener(brightcove.api.events.MediaEvent.PLAY,_onPlay);y.removeEventListener(brightcove.api.events.MediaEvent.PLAY,_hideLink);y.removeEventListener(brightcove.api.events.MediaEvent.STOP,_showLink)}s=t=C=B=y=w=x=v=u=null};return{id:_getID,init:_init,hide:_hide,play:_play,pause:_pause,destroy:_destroy,getVideoPlayer:_getVideoPlayer}};return{homeTemplateLoaded:q,brandTemplateLoaded:b,videoSliverTemplateLoaded:c,readyHandler:e,mediaSliverTemplateLoaded:a,timelineTemplateLoaded:g,HomeVideoController:k.HomeVideoController,BrandVideoController:k.BrandVideoController,VideoSliverController:k.VideoSliverController,MediaSliverController:k.MediaSliverController,TimelineController:k.TimelineVideoController,checkIfHasFlash:l,checkIfSupoortH264:m,initialize:p,destroy:_destroy}})(CK.VideoPlayerManager);$(document).ready(CK.VideoPlayerManager.initialize);