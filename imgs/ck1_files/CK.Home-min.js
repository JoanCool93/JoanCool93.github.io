window.CK=window.CK||{};CK.Home={};CK.Home=(function(u,j){var h=false,r=true,c={},l,p,g,f,m=false,B=[],D=function(){if(h){return}var H=$("#logo");H.css("cursor","default");p=0;l=CK.VideoPlayerManager.HomeVideoController;var G=navigator.userAgent.toLowerCase();if(G.indexOf("safari/")!==-1&&G.indexOf("windows")!==-1){m=true}i();F();w();$(".tile-home, .tile-home-mini").each(function(J){var I=$(this);var K=$("<div></div>",{"class":"dim"});K.appendTo(I);K.hide()});h=true},F=function(){var G=$("#home-tiles-container").height(),K=$("#content-home"),I=$("#content-main"),J=K.height(),H=(J+G);I.css("height",H);K.css("height",H);_homeHeight=H},o=function(){if(g){clearInterval(g)}g=null;l.pauseAll()},z=function(){o();var G=1024*15;g=setInterval(k,G);v(p)},t=function(){o();$(window).unbind("blur",o);$(window).unbind("focus",z)},C=function(){z();$(window).bind("blur",o);$(window).bind("focus",z)},k=function(){var L=$(".carousel-stepper.selected"),M=$(".homepage-content"),H=1340,G=$(".carousel-stepper"),K=800,J=M.size();if(p<J-1){p++;M.each(function(O){var N=$(this),P=parseInt(N.css("left"));N.show().animate({left:P-H},600,"easeOutQuad",function(){if(O==J-1){L.removeClass("selected");G.eq(p).addClass("selected");v(p)}})})}else{p=0;M.each(function(O){var N=$(this),P=parseInt(N.css("left"));if(O<=J-2){N.css("left",H*(O+1));P=parseInt(N.css("left"))}N.show().animate({left:P-H},600,"easeOutQuad",function(){if(O==J-1){L.removeClass("selected");G.eq(p).addClass("selected");v(p);N.css("left",H*O)}})})}var I=M.eq(p);if(I.is(".content-dark")){$("#background-navigator").addClass("dark-controls")}else{$("#background-navigator").removeClass("dark-controls")}d(M.eq(p),100,K,100)},i=function(){$("a#bg-home-left, a#bg-home-right").bind("click touchend",b);$(".carousel-stepper").on("click touchend",x);var G=$(".tile-home, .tile-home-mini");G.bind("click touchend",n);G.hover(function(){var H=$(this),J=H.find(".dim"),I=H.find("div").eq(0);H.addClass("tile-hover");I.css({"background-color":"#cacaca"});J.stop().css("opacity",0).show().animate({opacity:0.4},50)},function(){var I=$(this),K=I.find(".dim"),J=I.find("div").eq(0),H;I.removeClass("tile-hover");if(J.is(".light")){H="#fff"}else{H="#1a1a1a"}J.css({"background-color":H});K.stop().css("opacity",0).animate({opacity:1},50).hide()})},w=function(){var N=$(".homepage-content"),L=N.size(),J,G=$("#bg-indicator"),H=$("#home-tiles-container").css("top");$("#home-tiles-container").stop().hide().css({opacity:0,top:"422px"});e($(N[0]),L);for(var I=0;I<L;I++){var M=$("<a />",{"data-indicator":I,href:"#","class":"carousel-stepper"}),K=N.eq(I);if(K.find("#home-hed")){B.push(K.find("#home-hed"))}M.html(I+1);if(K.children(".home-video-wrapper")!=null){K.children(".home-video-wrapper").css("opacity",1);J=K.children(".home-video-wrapper").children("object").attr("id");if(K.children(".home-video-wrapper").children("span").length>0){J=K.children(".home-video-wrapper").children("span").children("object").attr("id")}if(CK.VideoPlayerManager.checkIfHasFlash()){c[I+1]=J}else{K.children(".home-video-wrapper").remove()}}if(I==0){M.addClass("selected")}G.append(M);K.css("left",(I*1340))}_currentCarousleIdx=0;if(CK.VideoPlayerManager.checkIfHasFlash()){$(".home-video-wrapper").bind("home_player_ready_event",E)}},e=function(H,G){H.css("opacity","0");$($("#home-hed")[0]).css({opacity:0,left:20});a(null,null);if(G==1){H.stop().show().animate({opacity:1},1).queue(function(){y()})}else{H.stop().show().animate({opacity:1},0).delay(900).queue(function(){y()})}},y=function(){$($("#home-hed")[0]).css("left",20).stop().animate({opacity:1,left:0},0);var I=$(".homepage-content");var H=I.size();var G=function(){$("#home-tiles-container").stop().hide().css({opacity:0,top:422}).show().delay(100).animate({opacity:1,top:430},50,function(){q($("#content-main"),$("#content-home"));if(H>1){C()}});if(H>1){$("#background-navigator").show().animate({opacity:1},100)}I.dequeue().show()};if(H==1){I.dequeue().stop().queue(G())}else{I.dequeue().stop().delay(100).queue(G())}},E=function(){for(var G in c){if(c[G]!=null){f=G;break}}l.playById(c[f]);if(!m){$(".home-video-wrapper").unbind()}},v=function(G){if(CK.VideoPlayerManager.checkIfHasFlash()){l.pauseAll();if(c[G+1]!=j){l.playById(c[G+1])}else{l.pauseAll()}}},x=function(I){I.preventDefault();z();var P=$(this),L=P.index(),J=1340,M=$(".homepage-content"),N=$(".carousel-stepper"),G=$(".carousel-stepper.selected"),K=p-L,Q=M.size(),H=560+(160*(Math.abs(K)-1));if(P.is(".selected")){return}if(CK.VideoPlayerManager.checkIfHasFlash()){l.pauseAll()}d(M.eq(L),H-(400+(20*Math.abs(K)-1)),800,(K<0)?100:-100);M.each(function(S){var R=$(this),T=R.index()*J;if(S==0){R.css("left",T-J)}R.stop().show().animate({left:T-(J*L)},560,"easeOutQuad",function(){if(S==Q-1){v(L)}})});p=L;G.removeClass("selected");N.eq(L).addClass("selected");var O=M.eq(L);if(O.is(".content-dark")){$("#background-navigator").addClass("dark-controls")}else{$("#background-navigator").removeClass("dark-controls")}},b=function(J,Q){J.preventDefault();z();var L=$(J.target),H=L.attr("id"),M=p,K=1340,I=false,N=$(".homepage-content"),R=N.size(),P,O=$(".carousel-stepper"),G=$(".carousel-stepper.selected");$("a#bg-home-left, a#bg-home-right").unbind("click",b);if(H=="bg-home-right"){if(M==R-1){M=0;I=true;A(M,N);p=-1}p++;P=N.eq(p);d(P,200,800,100)}else{if(M==0){M=R-1;I=true;A(M,N);p=R}p--;P=N.eq(p);d(P,200,800,-100)}N.each(function(T){var S=$(this),U=K*T;if(I){if(T==M){if(M==0){$(N[R-1]).animate({left:K*-1},560,"easeOutQuad",function(){$(N[R-1]).css("left",$(N[R-1]).index()*K)})}else{$(N[0]).animate({left:K},560,"easeOutQuad")}}if(T==p){S.animate({left:0},560,"easeOutExpo",function(){G.removeClass("selected");O.eq(p).addClass("selected");$("a#bg-home-left, a#bg-home-right").bind("click",b);v(p)})}}else{S.show().animate({left:U-(K*(p))},560,"easeOutQuad",function(){if(T==R-1){G.removeClass("selected");O.eq(p).addClass("selected");$("a#bg-home-left, a#bg-home-right").bind("click",b);v(p)}})}});if(P.is(".content-dark")){$("#background-navigator").addClass("dark-controls")}else{$("#background-navigator").removeClass("dark-controls")}},A=function(G,J){var H=1340,I=(G==0)?1:-1;J.each(function(L){var K=$(this),M=H*I;if(L!=p){K.css("left",M)}})},d=function(H,K,I,G){if(H){var J=H.find("#home-hed");if(J){J.hide().css("left",G);J.stop().delay(K).show().animate({left:0},I,"easeOutQuad")}}},n=function(J){J.preventDefault();var H=$(this),G=H.find("a").attr("href"),I=H.find("a").attr("target");if(I=="_blank"){window.open(G)}else{window.location.href=G}},a=function(O,H){var M=window.innerWidth?window.innerWidth:$(window).width(),N=$("#home-tiles-container"),G=(r)?10:400,J,I=$("#content-main"),K=$("#content-home");if(M<=1150){J=60;if(M>960){J+=Math.round((M-970)*0.5)}N.stop().animate({width:960,left:J},G);$(".tile-home, .tile-home-mini").stop().animate({marginRight:152},G);$.each(B,function(Q){var P=$(this);if(Q==B.length-1){P.stop().animate({marginLeft:80},G,function(){q(I,K)})}else{P.stop().animate({marginLeft:80},G)}})}else{if(M>1150&&M<1340){J=30;if(M>1150){J+=Math.round((M-1150)*0.3)}N.stop().animate({width:1150,left:J},G);$(".tile-home, .tile-home-mini").stop().animate({marginRight:69},G);$.each(B,function(Q){var P=$(this);if(Q==B.length-1){P.stop().animate({marginLeft:50},G,function(){q(I,K)})}else{P.stop().animate({marginLeft:50},G)}})}else{if(M>=1340){N.stop().animate({width:1500,left:30},G);var L=$(".tile-home, .tile-home-mini");L.stop().animate({marginRight:149},G);L.each(function(Q,R){var P=$(this);if(P.index()%3==2||P.offset().left>800){P.stop().css({"margin-right":0})}});$.each(B,function(Q){var P=$(this);if(Q==B.length-1){P.stop().animate({marginLeft:50},G,function(){q(I,K)})}else{P.stop().animate({marginLeft:50},G)}})}}}v(p);r=false},q=function(H,I){var G=$("#home-tiles-container").offset().top+$("#home-tiles-container").height()+80;H.css("height",G);I.css("height",G)};u.HomeAnalytics=function(){var L=false,I=function(){if(L){return}G();L=true},G=function(){$("a#bg-home-left, a#bg-home-right, .carousel-stepper").bind("click",function(){var M=$(this);K(M)});$(".tile-home, .tile-home-mini").bind("click",function(){var M=$(this);H(M)});$(".hed-button").bind("click",function(){var M=$(this);J(M)})},K=function(N){var P=$(".homepage-content"),O;P.each(function(){var Q=$(this),R=parseInt(Q.css("left"));if(R==0){O=Q.find("#home-hed h2").text()+" "+Q.find("#home-hed span").text()}});s.prop2="CarouselClick";s.prop3=O;var M=s.t();if(M){document.write(M)}},H=function(N){var O=N.find("div h4").text();s.prop2="ToutClick";s.prop3=O;var M=s.t();if(M){document.write(M)}},J=function(N){s.prop4=N.text();var M=s.t();if(M){document.write(M)}};return{initialize:I}}();return{initialize:D,handleHomeResize:a,stopCycle:o,restartCycle:z,stopFocus:t,restartFocus:C}})(CK.Home);$(document).ready(CK.Home.initialize);